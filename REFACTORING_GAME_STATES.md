# üéÆ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏–≥—Ä—ã

## üìä –°—Ç–∞—Ç—É—Å: –ó–ê–í–ï–†–®–Å–ù (–≠—Ç–∞–ø—ã 1-6)

**–î–∞—Ç–∞:** 21 –Ω–æ—è–±—Ä—è 2024
**–í–µ—Ä—Å–∏—è:** 1.0 (–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞)

---

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

–°–æ–∑–¥–∞–Ω–∞ **–Ω–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ –∏–≥—Ä—ã** –Ω–∞ –±–∞–∑–µ —á—ë—Ç–∫–æ–π –ª–æ–≥–∏–∫–∏ –±–∞–∫–∫–∞—Ä–∞.

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

1. **GameStateManager** - —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏–π
2. **6 —á—ë—Ç–∫–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏–≥—Ä—ã** –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∞–≤–∏–ª –±–∞–∫–∫–∞—Ä–∞
3. **–§—É–Ω–∫—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è** –ø–æ –∫–∞—Ä—Ç–∞–º –Ω–∞ —Å—Ç–æ–ª–µ
4. **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–µ–π—Å—Ç–≤–∏–π** —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
5. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫** –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑–¥–∞—á–∏
6. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞** —Å–æ —Å—Ç–∞—Ä–æ–π —Å–∏—Å—Ç–µ–º–æ–π
7. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã 2 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–∞**

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

### 6 —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏–≥—Ä—ã

```
1. WAITING (–û–∂–∏–¥–∞–Ω–∏–µ)
   - –ö–∞—Ä—Ç—ã —Å–∫—Ä—ã—Ç—ã
   - –ú–æ–∂–Ω–æ: –Ω–∞–∂–∞—Ç—å "–ö–∞—Ä—Ç—ã"
   - –ù–µ–ª—å–∑—è: –≤—ã–±—Ä–∞—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è, –∑–∞–∫–∞–∑–∞—Ç—å –∫–∞—Ä—Ç—ã

2. CARD_TO_EACH (–ö–∞—Ä—Ç–∞ –∫–∞–∂–¥–æ–º—É)
   - –ë–∞–Ω–∫–∏—Ä 0-2, –ò–≥—Ä–æ–∫ 0-5
   - –ú–æ–∂–Ω–æ: –∑–∞–∫–∞–∑–∞—Ç—å –∫–∞—Ä—Ç—É –∏–≥—Ä–æ–∫—É –ò –±–∞–Ω–∫–∏—Ä—É (–æ–±–µ!)
   - –ù–µ–ª—å–∑—è: —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –∫–∞—Ä—Ç—É, –≤—ã–±—Ä–∞—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è

3. CARD_TO_PLAYER (–ö–∞—Ä—Ç–∞ –∏–≥—Ä–æ–∫—É)
   - –ë–∞–Ω–∫–∏—Ä 3-7, –ò–≥—Ä–æ–∫ 0-5
   - –ú–æ–∂–Ω–æ: –∑–∞–∫–∞–∑–∞—Ç—å –∫–∞—Ä—Ç—É –∏–≥—Ä–æ–∫—É
   - –ù–µ–ª—å–∑—è: –∫–∞—Ä—Ç—É –±–∞–Ω–∫–∏—Ä—É, –≤—ã–±—Ä–∞—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è

4. CARD_TO_BANKER (–ö–∞—Ä—Ç–∞ –±–∞–Ω–∫–∏—Ä—É)
   - –ë–∞–Ω–∫–∏—Ä 0-5, –ò–≥—Ä–æ–∫ 6-7
   - –ú–æ–∂–Ω–æ: –∑–∞–∫–∞–∑–∞—Ç—å –∫–∞—Ä—Ç—É –±–∞–Ω–∫–∏—Ä—É
   - –ù–µ–ª—å–∑—è: –∫–∞—Ä—Ç—É –∏–≥—Ä–æ–∫—É, –≤—ã–±—Ä–∞—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è

5. CARD_TO_BANKER_AFTER_PLAYER (–ö–∞—Ä—Ç–∞ –±–∞–Ω–∫–∏—Ä—É –ø–æ—Å–ª–µ –∏–≥—Ä–æ–∫–∞)
   - –ë–∞–Ω–∫–∏—Ä 3-6, –∏–≥—Ä–æ–∫ —É–∂–µ –≤–∑—è–ª —Ç—Ä–µ—Ç—å—é
   - –ü—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è —Å–ª–æ–∂–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –±–∞–Ω–∫–∏—Ä–∞
   - –ú–æ–∂–Ω–æ: –∑–∞–∫–∞–∑–∞—Ç—å –∫–∞—Ä—Ç—É –±–∞–Ω–∫–∏—Ä—É
   - –ù–µ–ª—å–∑—è: –∫–∞—Ä—Ç—É –∏–≥—Ä–æ–∫—É, –≤—ã–±—Ä–∞—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è

6. CHOOSE_WINNER (–í—ã–±–æ—Ä –ø–æ–±–µ–¥–∏—Ç–µ–ª—è)
   - –í—Å–µ –∫–∞—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã –∏–ª–∏ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–∞—è 8-9
   - –ú–æ–∂–Ω–æ: –≤—ã–±—Ä–∞—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
   - –ù–µ–ª—å–∑—è: –∑–∞–∫–∞–∑—ã–≤–∞—Ç—å –∫–∞—Ä—Ç—ã
```

---

## üìù –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–∂–Ω–æ –ª–∏ –≤—ã–±—Ä–∞—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è

```gdscript
# –°–¢–ê–†–´–ô –ö–û–î (—É–¥–∞–ª—ë–Ω):
if not phase_manager.can_choose_winner():
    show_error("–°–Ω–∞—á–∞–ª–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ –∫–∞—Ä—Ç—ã!")
    return

# –ù–û–í–´–ô –ö–û–î:
if not GameStateManager.is_action_valid(GameStateManager.Action.SELECT_WINNER):
    var error_msg = GameStateManager.get_error_message(GameStateManager.Action.SELECT_WINNER)
    show_error(error_msg)
    return
```

### –ü—Ä–∏–º–µ—Ä 2: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫

```gdscript
func _on_settings_button_pressed():
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
    if not GameStateManager.can_change_settings():
        var msg = GameStateManager.get_settings_lock_message()
        toast_manager.show_error(msg)
        return

    settings_popup.popup_centered()
```

### –ü—Ä–∏–º–µ—Ä 3: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è

```gdscript
# –í GamePhaseManager –ø–æ—Å–ª–µ —Ä–∞–∑–¥–∞—á–∏ –∫–∞—Ä—Ç:
func deal_first_four():
    player_hand = [deck.draw(), deck.draw()]
    banker_hand = [deck.draw(), deck.draw()]
    ui.show_first_four_cards(player_hand, banker_hand)

    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç State 2, 3, 4 –∏–ª–∏ 6
    _update_game_state_manager()
```

### –ü—Ä–∏–º–µ—Ä 4: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π

```gdscript
# –í GameController._ready():
GameStateManager.state_changed.connect(_on_game_state_changed)

func _on_game_state_changed(old_state: int, new_state: int):
    var old_name = GameStateManager.get_state_name(old_state)
    var new_name = GameStateManager.get_state_name(new_state)
    print("üìä –°–æ—Å—Ç–æ—è–Ω–∏–µ: %s ‚Üí %s" % [old_name, new_name])
```

---

## üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –±–∞–≥–∏

### –ë–∞–≥ #1: –û—à–∏–±–æ—á–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤—ã–±–æ—Ä–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞ (`phase_manager.can_choose_winner()`) –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–ª–∞ –∫–æ–≥–¥–∞ –º–æ–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
- –ò–≥—Ä–æ–∫ —Ç–µ—Ä—è–ª –∂–∏–∑–Ω–∏ –∫–æ–≥–¥–∞ –ø—ã—Ç–∞–ª—Å—è –≤—ã–±—Ä–∞—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –º–æ–º–µ–Ω—Ç

**–†–µ—à–µ–Ω–∏–µ:**
- –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç State 6
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —á—ë—Ç–∫—É—é –ª–æ–≥–∏–∫—É –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–∞—Ä—Ç

**–§–∞–π–ª:** `scripts/GameController.gd:131-140`

---

### –ë–∞–≥ #2: –ù–µ –æ–±–Ω–æ–≤–ª—è–ª–æ—Å—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ —Ç—Ä–µ—Ç—å–µ–π –∫–∞—Ä—Ç—ã –±–∞–Ω–∫–∏—Ä–∞

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ë–∞–Ω–∫–∏—Ä 0, –ò–≥—Ä–æ–∫ 7 ‚Üí State 4 (–∫–∞—Ä—Ç–∞ –±–∞–Ω–∫–∏—Ä—É)
- –ë–∞–Ω–∫–∏—Ä –±–µ—Ä—ë—Ç —Ç—Ä–µ—Ç—å—é –∫–∞—Ä—Ç—É
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ—Å—Ç–∞–≤–∞–ª–æ—Å—å State 4 –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ State 6
- –ù–µ–ª—å–∑—è –±—ã–ª–æ –≤—ã–±—Ä–∞—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞: `if banker_third != null ‚Üí State 6`
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –ª—é–±–æ–π —Ç—Ä–µ—Ç—å–µ–π –∫–∞—Ä—Ç—ã

**–§–∞–π–ª:** `scripts/GameStateManager.gd:123-125`

---

## üìÅ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ |
|------|--------------|
| `scripts/GameStateManager.gd` | **–ù–û–í–´–ô** - —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏–π |
| `scripts/GameController.gd` | + –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è, + –ø—Ä–æ–≤–µ—Ä–∫–∏, + –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ |
| `scripts/GamePhaseManager.gd` | + –í—ã–∑–æ–≤—ã `_update_game_state_manager()` –ø–æ—Å–ª–µ –¥–µ–π—Å—Ç–≤–∏–π |
| `project.godot` | + Autoload: GameStateManager |

---

## üîÑ –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–ì–∏–±—Ä–∏–¥–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞)

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É:

‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–±–æ—Ä–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑–¥–∞—á–∏
‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ —Å–æ—Å—Ç–æ—è–Ω–∏–π

### –ß—Ç–æ –µ—â—ë —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ —Å—Ç–∞—Ä—É—é —Å–∏—Å—Ç–µ–º—É:

‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ—Ç—å–∏—Ö –∫–∞—Ä—Ç (—á–µ—Ä–µ–∑ State –∫–ª–∞—Å—Å—ã)
‚è≥ UI –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ ?/! (—á–µ—Ä–µ–∑ CardsDealtState)
‚è≥ –ü–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏ (—á–µ—Ä–µ–∑ change_state())

**–û–±–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –∏ –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç!**

---

## üöÄ –ß—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤ –±—É–¥—É—â–µ–º

### –≠—Ç–∞–ø 7: –ü–æ–ª–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É

**–ó–∞–¥–∞—á–∏:**
1. –ó–∞–º–µ–Ω–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–µ—Ç—å–∏—Ö –∫–∞—Ä—Ç –Ω–∞ GameStateManager
2. –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ State –∫–ª–∞—Å—Å—ã:
   - `scripts/states/StartState.gd`
   - `scripts/states/DealingState.gd`
   - `scripts/states/CardsDealtState.gd`
   - `scripts/states/PlayerCardOpenedState.gd`
   - `scripts/states/RevealedState.gd`
3. –£–ø—Ä–æ—Å—Ç–∏—Ç—å GamePhaseManager (–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ä–∞–∑–¥–∞—á—É –∫–∞—Ä—Ç)
4. –û–±–Ω–æ–≤–∏—Ç—å CLAUDE.md –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 2-3 —á–∞—Å–∞
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚≠ê
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π (—Å—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –º–µ—à–∞–µ—Ç)

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞ | –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ |
|----------|---------------|---------------|
| **–Ø—Å–Ω–æ—Å—Ç—å** | ‚≠ê‚≠ê‚≠ê (State –∫–ª–∞—Å—Å—ã —Å–º–µ—à–∏–≤–∞—é—Ç UI –∏ –ª–æ–≥–∏–∫—É) | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (—á–∏—Å—Ç–∞—è –∏–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞) |
| **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** | ‚≠ê‚≠ê (—Ä–∞–∑–º–∞–∑–∞–Ω–∞ –ø–æ State –∫–ª–∞—Å—Å–∞–º) | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–∞) |
| **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** | ‚≠ê‚≠ê‚≠ê (—Å–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ—Ö–æ–¥—ã) | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (–ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ) |
| **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** | ‚≠ê‚≠ê (—Ç–µ—Å–Ω–∞—è —Å–≤—è–∑—å UI –∏ –ª–æ–≥–∏–∫–∏) | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (—Å–ª–∞–±–∞—è —Å–≤—è–∑—å) |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | ‚≠ê‚≠ê (–º–æ–∂–Ω–æ —Å–ª–æ–º–∞—Ç—å, –±–∞–≥–∏) | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (—è–≤–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è) |
| **–ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å** | ‚≠ê‚≠ê‚≠ê (–Ω–∞–π–¥–µ–Ω—ã –±–∞–≥–∏) | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (–±–∞–≥–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã) |

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:

‚úÖ **–ù–∞—Ç—É—Ä–∞–ª—å–Ω–∞—è 8-9** ‚Üí —Å—Ä–∞–∑—É State 6
‚úÖ **–ë–∞–Ω–∫–∏—Ä 0-2, –ò–≥—Ä–æ–∫ 0-5** ‚Üí State 2 (–∫–∞—Ä—Ç–∞ –∫–∞–∂–¥–æ–º—É)
‚úÖ **–ë–∞–Ω–∫–∏—Ä 3-7, –ò–≥—Ä–æ–∫ 0-5** ‚Üí State 3 (–∫–∞—Ä—Ç–∞ –∏–≥—Ä–æ–∫—É)
‚úÖ **–ë–∞–Ω–∫–∏—Ä 0-5, –ò–≥—Ä–æ–∫ 6-7** ‚Üí State 4 (–∫–∞—Ä—Ç–∞ –±–∞–Ω–∫–∏—Ä—É)
‚úÖ **–ü–æ—Å–ª–µ —Ç—Ä–µ—Ç—å–µ–π –∫–∞—Ä—Ç—ã** ‚Üí –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –≤ State 5 –∏–ª–∏ 6
‚úÖ **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫** –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑–¥–∞—á–∏
‚úÖ **–í—ã–±–æ—Ä –ø–æ–±–µ–¥–∏—Ç–µ–ª—è** —Ç–æ–ª—å–∫–æ –≤ State 6

### –ù–∞–π–¥–µ–Ω–Ω—ã–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –±–∞–≥–∏:

‚úÖ –û—à–∏–±–æ—á–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤—ã–±–æ—Ä–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
‚úÖ –ù–µ –æ–±–Ω–æ–≤–ª—è–ª–æ—Å—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ —Ç—Ä–µ—Ç—å–µ–π –∫–∞—Ä—Ç—ã –±–∞–Ω–∫–∏—Ä–∞

---

## üìñ API Reference

### GameStateManager

#### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

```gdscript
# –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ –∫–∞—Ä—Ç–∞–º
func determine_state(
    cards_hidden: bool,
    player_hand: Array,
    banker_hand: Array,
    player_third = null,
    banker_third = null
) -> GameState

# –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
func update_state(new_state: GameState)

# –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏ –æ–±–Ω–æ–≤–∏—Ç—å (—É–¥–æ–±–Ω—ã–π –º–µ—Ç–æ–¥)
func determine_and_update_state(...)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–ø—É—Å—Ç–∏–º–æ—Å—Ç–∏ –¥–µ–π—Å—Ç–≤–∏—è
func is_action_valid(action: Action, state: GameState = current_state) -> bool

# –ü–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
func get_error_message(action: Action, state: GameState = current_state) -> String

# –ú–æ–∂–Ω–æ –ª–∏ –º–µ–Ω—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏?
func can_change_settings(state: GameState = current_state) -> bool

# –°–±—Ä–æ—Å–∏—Ç—å –≤ –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
func reset()
```

#### Enum GameState:

```gdscript
enum GameState {
    WAITING = 1,
    CARD_TO_EACH = 2,
    CARD_TO_PLAYER = 3,
    CARD_TO_BANKER = 4,
    CARD_TO_BANKER_AFTER_PLAYER = 5,
    CHOOSE_WINNER = 6
}
```

#### Enum Action:

```gdscript
enum Action {
    DEAL_CARDS,
    PLAYER_THIRD,
    BANKER_THIRD,
    SELECT_WINNER
}
```

#### –°–∏–≥–Ω–∞–ª—ã:

```gdscript
signal state_changed(old_state: GameState, new_state: GameState)
```

---

## üí° –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

1. **–°–æ—Å—Ç–æ—è–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∞–º–∏** - –Ω–∏–∫–∞–∫–∏—Ö —Ñ–ª–∞–≥–æ–≤ –∏–ª–∏ –∏—Å—Ç–æ—Ä–∏–∏
2. **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è** - –æ–¥–Ω–æ –º–µ—Å—Ç–æ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
3. **–Ø–≤–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è** - —á—ë—Ç–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ —á—Ç–æ –º–æ–∂–Ω–æ/–Ω–µ–ª—å–∑—è
4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** - —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
5. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤–∏–¥–Ω–æ –≤—Å–µ –ø–µ—Ä–µ—Ö–æ–¥—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π
6. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫** - –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑–¥–∞—á–∏

---

## üéì –ß—Ç–æ –º—ã —É–∑–Ω–∞–ª–∏

### –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å—Ç–∞—Ä–æ–π —Å–∏—Å—Ç–µ–º—ã:

1. **–°–º–µ—à–∏–≤–∞–Ω–∏–µ UI –∏ –ª–æ–≥–∏–∫–∏** –≤ State –∫–ª–∞—Å—Å–∞—Ö
2. **–û—à–∏–±–∫–∏ –≤ –ª–æ–≥–∏–∫–µ** can_choose_winner()
3. **–°–ª–æ–∂–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** (–Ω—É–∂–Ω–æ —ç–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ—Ö–æ–¥—ã)
4. **–†–∞–∑–º–∞–∑–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è** –ø–æ —Ä–∞–∑–Ω—ã–º —Ñ–∞–π–ª–∞–º

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã:

1. **–ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å** - –±–∞–≥–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
2. **–Ø—Å–Ω–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –Ω–µ–ª—å–∑—è —Å–¥–µ–ª–∞—Ç—å –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ
4. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
5. **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã

---

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

- **–ö–æ–º–º–∏—Ç–æ–≤:** 8
- **–§–∞–π–ª–æ–≤ —Å–æ–∑–¥–∞–Ω–æ:** 1 (GameStateManager.gd)
- **–§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ:** 3
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–æ:** ~400
- **–ë–∞–≥–æ–≤ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** 2
- **–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:** ~4 —á–∞—Å–∞
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚≠ê

---

## üéØ –ò—Ç–æ–≥–∏

### ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ:

1. –°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏
3. –ö–æ–¥ —Å—Ç–∞–ª –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ –∏ –ø–æ–Ω—è—Ç–Ω–µ–µ
4. –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å–æ —Å—Ç–∞—Ä–æ–π (–±–µ–∑ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤)
5. –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª–µ–∑–Ω—ã–µ —Ñ–∏—á–∏ (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)

### üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç:

**–ò–≥—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ!** –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç–æ—á–Ω–µ–µ —Å—Ç–∞—Ä–æ–π –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–æ—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è.

### üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

–í –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—É—é —Å–∏—Å—Ç–µ–º—É, –Ω–æ **—ç—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** - –æ–±–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤–º–µ—Å—Ç–µ –±–µ–∑ –ø—Ä–æ–±–ª–µ–º.

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è

–ö–æ–≥–¥–∞ –±—É–¥–µ—Ç–µ –≥–æ—Ç–æ–≤—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ (–≠—Ç–∞–ø 7):
1. –û—Ç–∫—Ä—ã—Ç—å —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç
2. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–∞–∑–¥–µ–ª "–ß—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤ –±—É–¥—É—â–µ–º"
3. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å —Ç–æ–≥–æ –∂–µ –º–µ—Å—Ç–∞

**–°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–¥–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ!** ‚ú®

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: 21 –Ω–æ—è–±—Ä—è 2024*
*–í–µ—Ä—Å–∏—è: 1.0*
*–°—Ç–∞—Ç—É—Å: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é*
