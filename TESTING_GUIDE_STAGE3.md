# üß™ –†–£–ö–û–í–û–î–°–¢–í–û –ü–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ - –≠–¢–ê–ü 3

**–î–∞—Ç–∞:** 2025-11-21
**–≠—Ç–∞–ø:** EventBus + –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É event-driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

---

## ‚úÖ –ß–¢–û –ë–´–õ–û –°–î–ï–õ–ê–ù–û

### 1. EventBus (28 —Å–æ–±—ã—Ç–∏–π)
- `scripts/autoload/EventBus.gd` —Å–æ–∑–¥–∞–Ω
- –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ `project.godot` –∫–∞–∫ autoload
- 28 —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –ø–æ 8 –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

### 2. StatsManager ‚Üí Autoload
- –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω –∏–∑ RefCounted –≤ Node (singleton)
- –ü–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ —Å–æ–±—ã—Ç–∏—è:
  - `action_correct` ‚Üí increment_correct()
  - `action_error` ‚Üí increment_error()
  - `payout_correct` ‚Üí increment_correct()
  - `payout_wrong` ‚Üí increment_error()

### 3. ToastManager ‚Üí Autoload
- –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω –≤ autoload singleton
- –ü–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ —Å–æ–±—ã—Ç–∏—è:
  - `show_toast_info` ‚Üí show_info()
  - `show_toast_success` ‚Üí show_success()
  - `show_toast_error` ‚Üí show_error()

### 4. GameController —É–ø—Ä–æ—â—ë–Ω
- –£–¥–∞–ª—ë–Ω BetManager (—É—Å—Ç–∞—Ä–µ–ª)
- –í—Å–µ –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ EventBus
- –†–∞–∑–º–µ—Ä: 349 ‚Üí 342 —Å—Ç—Ä–æ–∫–∏

### 5. GamePhaseManager
- –£–±—Ä–∞–Ω—ã –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã stats –∏ toast
- –í—Å–µ –≤—ã–∑–æ–≤—ã –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ EventBus.*.emit()

---

## üéØ –ß–¢–û –ù–£–ñ–ù–û –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–¢–¨

### –¢–µ—Å—Ç 1: –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∏–≥—Ä–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

**–®–∞–≥–∏:**
1. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ Godot 4.5
2. –ù–∞–∂–∞—Ç—å F5 (–∑–∞–ø—É—Å–∫ –∏–≥—Ä—ã)
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –ò–≥—Ä–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
   - –í –∫–æ–Ω—Å–æ–ª–∏ –≤–∏–¥–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è:
     ```
     üöå EventBus –≥–æ—Ç–æ–≤! –í—Å–µ —Å–æ–±—ã—Ç–∏—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω—ã.
     üìä StatsManager –≥–æ—Ç–æ–≤! –ü–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ EventBus.
     üçû ToastManager –≥–æ—Ç–æ–≤! –ü–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ EventBus.
     üéÆ GameStateManager –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
     ```
   - –ö–∞—Ä—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Å —Ä—É–±–∞—à–∫–∞–º–∏
   - –ö–Ω–æ–ø–∫–∞ "–ö–∞—Ä—Ç—ã" –∞–∫—Ç–∏–≤–Ω–∞
   - Toggles —Ç—Ä–µ—Ç—å–∏—Ö –∫–∞—Ä—Ç –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ –∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ

**–ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏:** –°–∫–æ–ø–∏—Ä—É–π –ø–æ–ª–Ω—ã–π –ª–æ–≥ –∫–æ–Ω—Å–æ–ª–∏

---

### –¢–µ—Å—Ç 2: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á–µ—Ä–µ–∑ EventBus
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ StatsManager –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è

**–®–∞–≥–∏:**
1. –†–∞–∑–¥–∞—Ç—å 4 –∫–∞—Ä—Ç—ã (–∫–Ω–æ–ø–∫–∞ "–ö–∞—Ä—Ç—ã")
2. –°–¥–µ–ª–∞—Ç—å –æ—à–∏–±–∫—É: –≤—ã–±—Ä–∞—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ —Å—Ç–∞–≤–∏—Ç—å –≥–∞–ª–æ—á–∫–∏ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ)
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫—Ä–∞—Å–Ω—ã–π toast —Å –æ—à–∏–±–∫–æ–π ‚úÖ
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è: "–û—à–∏–±–æ–∫: 1" ‚úÖ
   - –í –∫–æ–Ω—Å–æ–ª–∏ –≤–∏–¥–Ω–æ: `EventBus.action_error.emit()` ‚úÖ

4. –°–¥–µ–ª–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–∫–∞–∑–∞—Ç—å —Ç—Ä–µ—Ç—å—é –∫–∞—Ä—Ç—É)
5. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –ö–∞—Ä—Ç–∞ —Ä–∞–∑–¥–∞—ë—Ç—Å—è ‚úÖ
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è: "–ü—Ä–∞–≤–∏–ª—å–Ω–æ: 1" ‚úÖ

**–ï—Å–ª–∏ –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:** –ü—Ä–æ–±–ª–µ–º–∞ —Å EventBus ‚Üí StatsManager

---

### –¢–µ—Å—Ç 3: Toast —á–µ—Ä–µ–∑ EventBus
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ ToastManager –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ—Å—Ç—ã —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è

**–®–∞–≥–∏:**
1. –†–∞–∑–¥–∞—Ç—å 4 –∫–∞—Ä—Ç—ã
2. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –≤—ã–±—Ä–∞—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫—Ä–∞—Å–Ω—ã–π toast: "–°–Ω–∞—á–∞–ª–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤—Å–µ –∫–∞—Ä—Ç—ã" ‚úÖ
   - Toast –∏—Å—á–µ–∑–∞–µ—Ç —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã ‚úÖ

4. –î–æ–≤–µ—Å—Ç–∏ –∏–≥—Ä—É –¥–æ –∫–æ–Ω—Ü–∞, –≤—ã–±—Ä–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
5. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∑–µ–ª—ë–Ω—ã–π toast: "–ü—Ä–∞–≤–∏–ª—å–Ω–æ! ..." ‚úÖ
   - –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ–ø–∞–ø –≤—ã–ø–ª–∞—Ç—ã ‚úÖ

**–ï—Å–ª–∏ —Ç–æ—Å—Ç—ã –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è:** –ü—Ä–æ–±–ª–µ–º–∞ —Å EventBus ‚Üí ToastManager

---

### –¢–µ—Å—Ç 4: –ü–æ–ª–Ω—ã–π –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã

**–®–∞–≥–∏:**
1. –°—ã–≥—Ä–∞—Ç—å 5 –ø–æ–ª–Ω—ã—Ö —Ä–∞—É–Ω–¥–æ–≤:
   - –†–∞–∑–¥–∞—Ç—å –∫–∞—Ä—Ç—ã
   - –ü—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–∫–∞–∑–∞—Ç—å —Ç—Ä–µ—Ç—å–∏ –∫–∞—Ä—Ç—ã (–∏–ª–∏ –Ω–µ –∑–∞–∫–∞–∑—ã–≤–∞—Ç—å)
   - –í—ã–±—Ä–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
   - –ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –≤—ã–ø–ª–∞—Ç—É (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É)

2. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –í—Å–µ —Ç–æ—Å—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ ‚úÖ
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è: "–ü—Ä–∞–≤–∏–ª—å–Ω–æ: 5" (–∏–ª–∏ –±–æ–ª—å—à–µ, –µ—Å–ª–∏ —Å—á–∏—Ç–∞—é—Ç—Å—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è) ‚úÖ
   - –ü–æ–ø–∞–ø –≤—ã–ø–ª–∞—Ç—ã —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ
   - –ò–≥—Ä–∞ –Ω–µ –∑–∞–≤–∏—Å–∞–µ—Ç ‚úÖ
   - –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏ ‚úÖ

**–ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã:** –û–ø–∏—à–∏ –ø–æ–¥—Ä–æ–±–Ω–æ, –Ω–∞ –∫–∞–∫–æ–º —à–∞–≥–µ –≤–æ–∑–Ω–∏–∫–ª–∞ –æ—à–∏–±–∫–∞

---

### –¢–µ—Å—Ç 5: –†–µ–∂–∏–º –≤—ã–∂–∏–≤–∞–Ω–∏—è
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ç–µ—Ä—é –∂–∏–∑–Ω–µ–π —á–µ—Ä–µ–∑ EventBus

**–®–∞–≥–∏:**
1. –í–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –≤—ã–∂–∏–≤–∞–Ω–∏—è (–∫–Ω–æ–ø–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫)
2. –°–¥–µ–ª–∞—Ç—å –æ—à–∏–±–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã–±—Ä–∞—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è)
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –¢–µ—Ä—è–µ—Ç—Å—è 1 –∂–∏–∑–Ω—å (—Å–µ—Ä–¥–µ—á–∫–æ) ‚úÖ
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ù–ï –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è (—Å–∫—Ä—ã—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ –≤—ã–∂–∏–≤–∞–Ω–∏—è) ‚úÖ
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è toast —Å –æ—à–∏–±–∫–æ–π ‚úÖ

4. –ü–æ—Ç–µ—Ä—è—Ç—å –≤—Å–µ 3 –∂–∏–∑–Ω–∏
5. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–ø–∞–ø "Game Over" ‚úÖ
   - –ö–Ω–æ–ø–∫–∞ "Restart" —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ

**–ï—Å–ª–∏ –∂–∏–∑–Ω–∏ –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è:** –ü—Ä–æ–±–ª–µ–º–∞ —Å —Å–æ–±—ã—Ç–∏–µ–º `life_lost` –∏–ª–∏ `action_error`

---

## üêõ –ò–ó–í–ï–°–¢–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ (–µ—Å–ª–∏ –Ω–∞–π–¥—ë—à—å)

–ï—Å–ª–∏ –Ω–∞–π–¥—ë—à—å –±–∞–≥–∏, –æ–ø–∏—à–∏:
1. **–ß—Ç–æ –¥–µ–ª–∞–ª** (—à–∞–≥–∏ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è)
2. **–ß—Ç–æ –æ–∂–∏–¥–∞–ª** (–æ–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç)
3. **–ß—Ç–æ –ø–æ–ª—É—á–∏–ª** (—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç)
4. **–õ–æ–≥ –∫–æ–Ω—Å–æ–ª–∏** (–µ—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏)

---

## üìä –ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê

- ‚úÖ –ò–≥—Ä–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –í—Å–µ 3 autoload –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è (EventBus, StatsManager, ToastManager)
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ EventBus
- ‚úÖ –¢–æ—Å—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ EventBus
- ‚úÖ –†–µ–∂–∏–º –≤—ã–∂–∏–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç (–∂–∏–∑–Ω–∏ —Ç–µ—Ä—è—é—Ç—Å—è)
- ‚úÖ –ü–æ–ª–Ω—ã–π –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç–∞–µ—Ç (5+ —Ä–∞—É–Ω–¥–æ–≤ –±–µ–∑ –æ—à–∏–±–æ–∫)

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ô –≠–¢–ê–ü

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ **–≠—Ç–∞–ø—É 4: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è UI –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** (8 —á–∞—Å–æ–≤).
